<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heart Disease Analysis - Project 1</title>
    <style>
        body {
            font-family: Calibri, sans-serif;
            line-height: 1.6;
            margin: 20px;
            padding: 20px;
            background-color: #f4f4f4;
        }
        h1, h2 {
            color: #333;
        }
        pre {
            background: #9085BC;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        img {
            max-width: 100%;
            height: auto;
            margin-bottom: 20px;
            border-radius: 5px;
        }
    </style>
</head>
<body>

    <h1>Heart Disease Analysis using MySQL & Power BI</h1>
    
    <h2>Overview</h2>
    <p>In this project, I analyzed heart disease risk factors using a structured dataset containing patient demographics, medical history, and clinical measurements. 
        The data was stored in MySQL, and I utilized SQL queries to extract, clean, and transform key variables related to heart disease, including cholesterol levels, 
        blood pressure, ECG results, and exercise-induced angina. Tools & Technologies used: MySQL, Power BI, SQL, DAX</p>
    
    <h2>Queries with Visuals</h2>



	
<figure style="display: flex; justify-content: center; align-items: flex-start; gap: 20px;">
    <!-- Code Block -->
    <div style="display: flex; flex-direction: column; align-items: center; max-width: 50%;">
        <pre style="background-color: #f4f4f4; padding: 10px; border-radius: 5px; overflow-x: auto; white-space: pre-wrap; word-wrap: break-word; font-family: monospace; font-size: 14px; max-width: 100%; border: 1px solid #ddd;">
<code>
SELECT *
FROM heart_failure_staging
WHERE HeartDisease = 1;
</code>
        </pre>
        <figcaption>SQL query to filter patients with Heart Disease</figcaption>
    </div>

    <!-- Image Block -->
    <div style="display: flex; flex-direction: column; align-items: center; max-width: 50%;">
        <img src="images/ptaffectedbyhd.png" alt="Patients affected by Heart Disease" style="max-width: 100%; height: auto; border: 1px solid #ddd;">
        <figcaption>This displays the total amount of affected patients with Heart Disease</figcaption>
    </div>
</figure>





	

<figure style="display: flex; align-items: center; gap: 20px;">
    <pre>
<code>	
SELECT 
    HeartDisease, 
    AVG(Cholesterol) AS AvgCholesterol  
FROM heart_failure_staging  
GROUP BY HeartDisease;
</code>
    </pre>
<img src="images/avgcholesterol.png" alt="Patients affected by high Cholesterol and Heart Disease" style="max-width: 300px;" />
<figcaption> This query explains the average cholesterol in heart disease patients.</figcaption>
</figure>



<figure style="display: flex; align-items: center; gap: 20px;">
    <pre>
<code>	
SELECT 
	ChestPainType,
    COUNT(CASE WHEN HeartDisease = 1 THEN 1 End) AS HeartDiseaseSymptom
FROM heart_failure_staging
GROUP BY ChestPainType
ORDER BY HeartDiseaseSymptom DESC; 
</code>
    </pre>
<img src="images/chestpainHD.png" alt="Heart Disease ranked with Chest Pain" style="max-width: 300px;" />
<figcaption> This query explains what heart disease patients patients experience with chest pain. Using group by helps the analyst see the highest trends of chest pain types with Heart Disease.
The reason for using COUNT(CASE) to ensure no NULL values that may have been overlooked when data cleaning are included scuing the data. </figcaption>
</figure>


<figure style="display: flex; align-items: center; gap: 20px;">
    <pre>
<code>	
SELECT 
    CASE
        WHEN age BETWEEN 28 AND 35 THEN '28-35'
        WHEN age BETWEEN 36 AND 50 THEN '36-50'
        WHEN age BETWEEN 51 AND 64 THEN '51-64'
        WHEN age > 64 THEN '65+'
    END AS age_groups,
    COUNT(*) AS TotalPatients,
    COUNT(CASE WHEN HeartDisease = 1 THEN 1 END) AS HeartDiseasePatients,
    ROUND(100.0 * COUNT(CASE WHEN HeartDisease = 1 THEN 1 END) / COUNT(*), 2) AS HeartDisease_Risk_Percentage,
    ROUND(AVG(FastingBS), 2) AS AvgFastingBS,
    ROUND(AVG(RestingBP), 2) AS AvgRestingBP,
    ROUND(AVG(MaxHR), 2) AS AvgMaxHR
FROM heart_failure_staging
GROUP BY age_groups
ORDER BY age_groups;
    </code>
    </pre>
<img src="images/HDriskbyage.png" alt="Heart Disease Risk by Age Group" style="max-width: 300px;" />
<figcaption> this query is cool </figcaption>
</figure>


	
<figure style="display: flex; align-items: center; gap: 20px;">
    <pre>
<code>
select 
	case
		when restingBP BETWEEN 0 and 95 then '80-95'
        when restingBP BETWEEN 96 and 110 then '96-110'
        when restingBP BETWEEN 111 and 130 then '111-130'
        when restingBP BETWEEN 131 and 150 then '131-150'
        when restingBP > 150 then '150+'
    end as restingBP_ranges,
	count(*) as totalHeartDiseasePatients
from heart_failure_staging
where HeartDisease = 1
group by RestingBP_ranges
order by totalHeartDiseasePatients asc;
</code>
    </pre>
<img src="images/restingpulserangesHD.png" alt="Resting Pulse Heart Disease Patients" style="max-width: 300px;" />
<figcaption> this query is cool </figcaption>
</figure>





<figure style="display: flex; align-items: center; gap: 20px;">
    <pre>
<code>		
SELECT *
FROM (
    SELECT 
        Age, 
        Cholesterol, 
        RANK() OVER (
            PARTITION BY 
                CASE 
                    WHEN Age BETWEEN 28 AND 35 THEN '28-35'
                    WHEN Age BETWEEN 36 AND 50 THEN '36-50'
                    WHEN Age BETWEEN 51 AND 64 THEN '51-64'
                    ELSE '65+' 
                END
            ORDER BY Cholesterol DESC
        ) AS Cholesterol_Rank
    FROM heart_failure_staging
) ranked
WHERE Cholesterol_Rank <= 5; 
</code>
    </pre>
<img src="images/avgcholesterolbyagegroup.png" alt="Heart Disease ranked with Chest Pain" style="max-width: 300px;" />
<figcaption> I created a CTE to help visualize Cholesterol levels among age groups. I limited it by top 5 highest Cholesterol regardless of 
	Heart disease or not. Since Cholesterol is a risk factor, seeing the highest cholesterols amoung age groups would provide useful insight. </figcaption>
</figure>




<figure style="display: flex; align-items: center; gap: 20px;">
    <pre>
<code>		
		WITH HighRiskPatients AS (
    SELECT 
        HeartDisease,
        CASE WHEN Cholesterol > 200 THEN 1 ELSE 0 END AS HighCholesterol,
        CASE WHEN RestingBP > 130 THEN 1 ELSE 0 END AS HighBloodPressure,
        CASE WHEN ExerciseAngina = 'Y' THEN 1 ELSE 0 END AS ExerciseAngina,
        CASE WHEN FastingBS = 1 THEN 1 ELSE 0 END AS HighBloodSugar,
        CASE WHEN ST_Slope IN ('Flat', 'Down') THEN 1 ELSE 0 END AS AbnormalSTSlope
    FROM heart_failure_staging
    WHERE HeartDisease = 1
)

SELECT 
    'High Cholesterol' AS RiskFactor, 
    COUNT(*) AS Frequency
FROM HighRiskPatients
WHERE HighCholesterol = 1
UNION ALL
SELECT 
    'High Blood Pressure' AS RiskFactor, 
    COUNT(*) AS Frequency
FROM HighRiskPatients
WHERE HighBloodPressure = 1
UNION ALL
SELECT 
    'Exercise Angina' AS RiskFactor, 
    COUNT(*) AS Frequency
FROM HighRiskPatients
WHERE ExerciseAngina = 1
UNION ALL
SELECT 
    'High Blood Sugar' AS RiskFactor, 
    COUNT(*) AS Frequency
FROM HighRiskPatients
WHERE HighBloodSugar = 1
UNION ALL
SELECT 
    'Abnormal ST Slope' AS RiskFactor, 
    COUNT(*) AS Frequency
FROM HighRiskPatients
WHERE AbnormalSTSlope = 1
ORDER BY Frequency DESC
LIMIT 5;
 </code>
    </pre>
<img src="images/riskfactorsforHD.png" alt="Heart Disease Risk Factors" style="max-width: 300px;" />
<figcaption> There's alot going on here. </figcaption>
</figure>

    <h2>If you want to see the complete project, download these files.</h2>
    <p><a href="heart_failure_project.sql" download>Download SQL Queries</a></p>
    <p><a href="heart_failure_dashboard.pbix" download>Download Power BI Dashboard</a></p>

    <caption id="bottom">Tools & Technologies: MySQL, Power BI, SQL, DAX</caption>
</body>
</html>

